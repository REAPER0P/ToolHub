<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced Image Cropper Tool</title>

<!-- CropperJS CSS -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css"/>

<style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
    body{
        background: radial-gradient(circle at 20% 20%, #2a2a72, #009ffd);
        min-height:100vh;
        display:flex;
        justify-content:center;
        align-items:center;
        padding:20px;
        color:#fff;
    }
    .container{
        width:100%;
        max-width:520px;
        background:rgba(255,255,255,0.10);
        backdrop-filter:blur(20px);
        padding:25px;
        border-radius:22px;
        box-shadow:0 0 25px rgba(0,0,0,0.4);
    }
    h1{
        text-align:center;
        font-size:1.9rem;
        margin-bottom:15px;
        background:linear-gradient(45deg,#fff,#d4ffec);
        -webkit-background-clip:text;
        -webkit-text-fill-color:transparent;
    }
    button, select{
        width:100%;
        padding:12px;
        border:none;
        border-radius:12px;
        margin:10px 0;
        font-size:1rem;
        font-weight:600;
        cursor:pointer;
    }
    button{
        background:linear-gradient(45deg,#00e0ff,#4be1ec);
    }
    button:hover{
        transform:scale(1.02);
    }
    select{
        background:rgba(255,255,255,0.25);
        color:#fff;
    }
    #imgBox{
        width:100%;
        max-height:350px;
        margin-top:10px;
        background:#000;
        border-radius:15px;
        overflow:hidden;
    }
    img{
        width:100%;
        display:block;
        max-height:350px;
    }
</style>
</head>

<body>
<div class="container">
    <h1>Advanced Image Cropper</h1>

    <input id="upload" type="file" accept="image/*" style="display:none;">
    <button onclick="document.getElementById('upload').click()">üì§ Upload Image</button>

    <select id="ratio">
        <option value="free">Free Crop</option>
        <option value="1">1:1 Square</option>
        <option value="16/9">16:9</option>
        <option value="4/3">4:3</option>
        <option value="3/2">3:2</option>
        <option value="circle">Circle Crop</option>
    </select>

    <button onclick="zoomIn()">üîç Zoom In</button>
    <button onclick="zoomOut()">üîç Zoom Out</button>

    <div id="imgBox">
        <img id="preview">
    </div>

    <button onclick="downloadCrop()">Download Cropped Image</button>
</div>

<!-- CropperJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

<script>
let cropper;
const upload = document.getElementById("upload");
const preview = document.getElementById("preview");

upload.addEventListener("change", e => {
    const file = e.target.files[0];
    if (!file) return;
    preview.src = URL.createObjectURL(file);

    if (cropper) cropper.destroy();

    preview.onload = () => {
        cropper = new Cropper(preview, {
            viewMode: 1,
            dragMode: "move",
            responsive: true,
            background: false,
            movable: true,
            zoomable: true,
            rotatable: false,
            scalable: false,
        });
    };
});

document.getElementById("ratio").addEventListener("change", (e)=>{
    let val = e.target.value;

    if(!cropper) return;

    if(val === "free"){
        cropper.setAspectRatio(NaN);
    }
    else if(val === "circle"){
        cropper.setAspectRatio(1);
        cropper.crop();

        // Make circle crop using CSS mask
        preview.style.borderRadius = "50%";
    }
    else{
        preview.style.borderRadius = "0";
        cropper.setAspectRatio(eval(val));
    }
});

function zoomIn(){
    if(cropper) cropper.zoom(0.1);
}
function zoomOut(){
    if(cropper) cropper.zoom(-0.1);
}

function downloadCrop(){
    if(!cropper) return alert("Upload image first!");

    let canvas = cropper.getCroppedCanvas();

    canvas.toBlob((blob)=>{
        let link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "cropped-image.png";
        link.click();
    });
}
</script>
</body>
</html>
